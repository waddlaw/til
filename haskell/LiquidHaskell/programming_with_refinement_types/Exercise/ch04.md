# Polymorphism

## Exercise 4.1 (Vector Head)

### 問題

`head''` の `undefined` を入力の `vec` が空でない時のみ値を返すような実装に置き換えよ、

```haskell
head'' :: Vector a -> Maybe a
head'' vec = undefined
```

上記のコードを `LH` にかけると `SAFE` が返る

### 解答

```haskell
import Prelude hiding (head, null)
import Data.Vector

{-@ head' :: Vector a -> Maybe a @-}
head' :: Vector a -> Maybe a
head' vec
  | null vec = Nothing
  | otherwise = Just $ V.head vec
```

### 別解


```haskell
{-@ head'' :: Vector a -> Maybe a @-}
head'' :: Vector a -> Maybe a
head'' vec | length vec == 0 = Nothing
           | otherwise = Just (vec ! 0)
```

## Exercise 4.2 (Unsafe Lookup)

`unsafeLookup` 関数は `(!)` 演算子の引数を反転させた関数である。

以下の実装が `LiquidHaskell` で受理されるように `unsafeLookup` 関数の仕様を変更せよ。

```haskell
{-@ unsafeLookup :: Int -> Vector a -> a @-}
unsafeLookup index vec = vec ! index
```

### 解答

```haskell
import Data.Vector

-- Exercise 4.2
{-@ unsafeLookup :: x:Nat -> {v:Vector a | x < vlen v} -> a @-}
unsafeLookup :: Int -> Vector a -> a
unsafeLookup index vec = vec ! index
```
